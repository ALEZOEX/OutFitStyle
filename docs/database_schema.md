# OutfitStyle - Инициализация базы данных

## Обзор

Этот файл описывает полную схему базы данных для OutfitStyle, реализующей архитектуру Planner → Retrieval → Ranking с централизованными нормами и приоритетами источников.

## Структура

### 1. subcategory_specs (словарь + нормы для Planner)
- Содержит нормы для каждой подкатегории одежды
- Используется Planner'ом для генерации плана подбора
- Позволяет учитывать погодные условия и температурные диапазоны

### 2. clothing_items (каталог)
- Основная таблица для хранения вещей
- Поддерживает массив материалов (TEXT[])
- Связана с subcategory_specs через внешний ключ
- Включает атрибуты для эффективного Retrieval

### 3. wardrobe_items (личные вещи пользователей)
- Связывает пользователей с их личными вещами
- Отмечает принадлежность (is_owned) для приоритезации

## Использование

Для инициализации новой базы данных:

```bash
psql -h localhost -U your_user -d your_database -f database/init_v2.sql
```

Или как часть миграции:

```bash
# Миграция 0001_v2_init_schema.sql включает этот файл
psql -h localhost -U your_user -d your_database -f migrations/0001_v2_init_schema.sql
```

## Приоритеты источников

В системе реализована иерархия приоритетов источников:
1. user (личные вещи пользователя) - наивысший приоритет
2. manual (ручное добавление) - средний приоритет
3. partner (партнерские данные) - средний приоритет
4. synthetic (синтетические данные) - наименьший приоритет

## Индексы для эффективного Retrieval

Созданы ключевые индексы для быстрого поиска:
- clothing_items_cat_subcat_idx (категория, подкатегория)
- clothing_items_cat_warmth_idx (категория, уровень теплоты)
- clothing_items_temp_idx (диапазон температур)

Эти индексы обеспечивают эффективную работу компонента Retrieval в архитектуре.